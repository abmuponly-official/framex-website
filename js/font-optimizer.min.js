(function(){'use strict';const fontConfig={fonts:[{family:'Inter',weights:['300','400','500','600','700'],styles:['normal'],display:'swap',preload:['400','600','700'],subset:'latin-ext'}],strategy:'preload',//'preload','prefetch',or 'lazy' timeout:3000,sessionStorageKey:'framex-fonts-loaded',cssClass:'fonts-loaded'};const fontsLoaded=()=>{try{return sessionStorage.getItem(fontConfig.sessionStorageKey)==='true';}catch(e){return false;}};const markFontsLoaded=()=>{document.documentElement.classList.add(fontConfig.cssClass);try{sessionStorage.setItem(fontConfig.sessionStorageKey,'true');}catch(e){}};const generateFontUrl=(font)=>{const baseUrl='https://fonts.googleapis.com/css2';const families=[];const familyString=`family=${font.family}:wght@${font.weights.join(';')}`;families.push(familyString);const params=[families.join('&'),`display=${font.display}`,font.subset?`subset=${font.subset}`:''].filter(Boolean).join('&');return `${baseUrl}?${params}`;};const preloadFonts=()=>{fontConfig.fonts.forEach(font=>{if(font.preload&&font.preload.length>0){const fontUrl=generateFontUrl({...font,weights:font.preload});const link=document.createElement('link');link.rel='preload';link.as='style';link.href=fontUrl;link.onload=function(){this.rel='stylesheet';markFontsLoaded();};document.head.appendChild(link);const preconnect=document.createElement('link');preconnect.rel='preconnect';preconnect.href='https://fonts.gstatic.com';preconnect.crossOrigin='anonymous';document.head.appendChild(preconnect);}});};const loadFontsWithAPI=async()=>{if(!('fonts' in document)){return false;}try{const fontPromises=[];fontConfig.fonts.forEach(font=>{font.weights.forEach(weight=>{font.styles.forEach(style=>{const fontFace=new FontFace(font.family,`url(https://fonts.gstatic.com/s/inter/v12/UcC73FwL.woff2)format('woff2')`,{weight:weight,style:style,display:font.display});document.fonts.add(fontFace);fontPromises.push(fontFace.load());});});});await Promise.all(fontPromises);markFontsLoaded();return true;}catch(error){console.error('Font loading failed:',error);return false;}};const lazyLoadFonts=()=>{const observer=new IntersectionObserver((entries)=>{entries.forEach(entry=>{if(entry.isIntersecting){const element=entry.target;const fontWeight=window.getComputedStyle(element).fontWeight;if(!document.fonts.check(`${fontWeight}1em Inter`)){loadFontWeight('Inter',fontWeight);}observer.unobserve(element);}});},{rootMargin:'50px'});const elements=document.querySelectorAll('[class*="font-"],h1,h2,h3,h4,h5,h6,.bold,.light');elements.forEach(el=>observer.observe(el));};const loadFontWeight=async(family,weight)=>{if(!('fonts' in document))return;try{const fontFace=new FontFace(family,`url(https://fonts.gstatic.com/s/inter/v12/UcC73FwL.woff2)format('woff2')`,{weight:weight,style:'normal',display:'swap'});document.fonts.add(fontFace);await fontFace.load();}catch(error){console.error(`Failed to load font ${family}${weight}:`,error);}};const injectFontCSS=()=>{const style=document.createElement('style');style.textContent=` html{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;text-rendering:optimizeLegibility;font-feature-settings:"kern" 1,"liga" 1;}body{font-family:'Inter',-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;font-display:swap;}html:not(.fonts-loaded)body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;}.font-light{font-weight:300;}.font-normal{font-weight:400;}.font-medium{font-weight:500;}.font-semibold{font-weight:600;}.font-bold{font-weight:700;}h1,h2,h3,h4,h5,h6{font-synthesis:none;line-height:1.2;}@font-face{font-family:'Inter Subset';src:local('Inter'),local('Inter-Regular');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;}`;document.head.appendChild(style);};const handleTimeout=()=>{setTimeout(()=>{if(!document.documentElement.classList.contains(fontConfig.cssClass)){console.warn('Font loading timeout-using fallback fonts');markFontsLoaded();}},fontConfig.timeout);};const addResourceHints=()=>{const dnsPrefetch=document.createElement('link');dnsPrefetch.rel='dns-prefetch';dnsPrefetch.href='https://fonts.googleapis.com';document.head.appendChild(dnsPrefetch);const preconnect1=document.createElement('link');preconnect1.rel='preconnect';preconnect1.href='https://fonts.googleapis.com';document.head.appendChild(preconnect1);const preconnect2=document.createElement('link');preconnect2.rel='preconnect';preconnect2.href='https://fonts.gstatic.com';preconnect2.crossOrigin='anonymous';document.head.appendChild(preconnect2);};const init=()=>{addResourceHints();injectFontCSS();if(fontsLoaded()){markFontsLoaded();return;}switch(fontConfig.strategy){case 'preload':preloadFonts();break;case 'lazy':lazyLoadFonts();break;default:if('fonts' in document){loadFontsWithAPI();}else{preloadFonts();}}handleTimeout();};window.FontOptimizer={init:init,load:loadFontsWithAPI,preload:preloadFonts,lazyLoad:lazyLoadFonts,isLoaded:fontsLoaded};if(document.readyState==='loading'){document.addEventListener('DOMContentLoaded',init);}else{init();}window.addEventListener('load',()=>{if(!fontsLoaded()){init();}});})();