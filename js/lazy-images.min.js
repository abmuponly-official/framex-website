(function(){'use strict';const PLACEHOLDER='data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP let supportsWebP=false;const webpTest=new Image();webpTest.onload=webpTest.onerror=function(){supportsWebP=(webpTest.height===2);};webpTest.src='data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA const imageObserver=new IntersectionObserver((entries,observer)=>{entries.forEach(entry=>{if(entry.isIntersecting){loadImage(entry.target);observer.unobserve(entry.target);}});},{rootMargin:'50px 0px',threshold:0.01});function loadImage(img){const src=getBestImageSrc(img);const imageLoader=new Image();imageLoader.onload=function(){img.src=this.src;img.classList.remove('lazy');img.classList.add('loaded');};imageLoader.onerror=function(){if(img.dataset.src!==img.dataset.fallback){imageLoader.src=img.dataset.fallback||img.dataset.src;}else{img.classList.add('error');}};imageLoader.src=src;}function getBestImageSrc(img){const dataSrc=img.dataset.src;const dataWebp=img.dataset.webp;if(supportsWebP&&dataWebp){return dataWebp;}return dataSrc;}function processImages(){const lazyImages=document.querySelectorAll('img[data-src]:not(.processed)');lazyImages.forEach(img=>{img.classList.add('processed','lazy');if(!img.src){img.src=PLACEHOLDER;}img.style.transition='opacity 0.3s ease-in-out';img.style.opacity='0.5';if('IntersectionObserver' in window){imageObserver.observe(img);}else{loadImage(img);}});}function addLazyStyles(){const style=document.createElement('style');style.textContent=` .lazy{opacity:0.5;transition:opacity 0.3s ease-in-out;}.lazy.loaded{opacity:1;}.lazy.error{opacity:0.3;background:#f0f0f0;}`;document.head.appendChild(style);}function init(){addLazyStyles();processImages();const observer=new MutationObserver(()=>{processImages();});observer.observe(document.body,{childList:true,subtree:true});}if(document.readyState==='loading'){document.addEventListener('DOMContentLoaded',init);}else{init();}})();